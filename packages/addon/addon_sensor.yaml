sensor:

  - platform: command_line
    name: Supervisor updates
    command: 'curl http://supervisor/supervisor/info -H "Authorization: Bearer $(printenv SUPERVISOR_TOKEN)" | jq ''{"newest_version":.data.version_latest,"current_version":.data.version,"addons":[.data.addons[] | select(.version != .installed)]}'''
    value_template: "{{ value_json.addons | length }}"
    json_attributes:
      - newest_version
      - current_version
      - addons

#################################
#  ╔═╗╔╗╔╔═╗╔═╗╔═╗╦ ╦╔═╗╔╦╗╔═╗  #
#  ╚═╗║║║╠═╣╠═╝╚═╗╠═╣║ ║ ║ ╚═╗  #
#  ╚═╝╝╚╝╩ ╩╩  ╚═╝╩ ╩╚═╝ ╩ ╚═╝  #
#################################

  - platform: rest
    resource: http://10.0.1.11:8123/api/hassio/snapshots
    name: snapshots
    value_template: '{{ value_json.data.snapshots | length }}'
    json_attributes_path: "$.data"
    json_attributes:
      - snapshots
    timeout: 5
    headers:
      Authorization: !secret token_ha
      Content-Type: application/json

#####################
#  ╔═╗╔═╗╔╦╗╔╗ ╔═╗  #
#  ╚═╗╠═╣║║║╠╩╗╠═╣  #
#  ╚═╝╩ ╩╩ ╩╚═╝╩ ╩  #
#####################

  - platform: rest
    resource: http://10.0.1.11:8123/api/hassio/addons/core_samba/info
    name: samba
    value_template: '{{ value_json.data.state }}'
    json_attributes_path: "$.data"
    json_attributes:
      - version
      - version_latest
    timeout: 5
    headers:
      Authorization: !secret token_ha
      Content-Type: application/json

  - platform: rest
    resource: http://10.0.1.11:8123/api/hassio/addons/a0d7b954_vscode/info
    name: vscode
    value_template: '{{ value_json.data.state }}'
    json_attributes_path: "$.data"
    json_attributes:
      - version
      - version_latest
    timeout: 5
    headers:
      Authorization: !secret token_ha
      Content-Type: application/json

  - platform: rest
    resource: http://10.0.1.11:8123/api/hassio/addons/a0d7b954_ssh/info
    name: web ssh
    value_template: '{{ value_json.data.state }}'
    json_attributes_path: "$.data"
    json_attributes:
      - version
      - version_latest
    timeout: 5
    headers:
      Authorization: !secret token_ha
      Content-Type: application/json

  - platform: rest
    resource: http://10.0.1.11:8123/api/hassio/addons/7ad98f9c_zigbee2mqtt/info
    name: zigbee2mqtt
    value_template: '{{ value_json.data.state }}'
    json_attributes_path: "$.data"
    json_attributes:
      - version
      - version_latest
    timeout: 5
    headers:
      Authorization: !secret token_ha
      Content-Type: application/json

  - platform: rest
    resource: http://10.0.1.11:8123/api/hassio/addons/core_mariadb/info
    name: mariadb
    value_template: '{{ value_json.data.state }}'
    json_attributes_path: "$.data"
    json_attributes:
      - version
      - version_latest
    timeout: 5
    headers:
      Authorization: !secret token_ha
      Content-Type: application/json
